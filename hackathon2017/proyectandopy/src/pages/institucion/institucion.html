<ion-header>
  <ion-title class="app-title" col-12 >proyectandoPy</ion-title>

  <ion-navbar  #content id="subnavbar" [ngClass]="(showSearchBar ? 'hide_tab' : '')">
    <ion-title class="app-subtitle" ><ion-label> Instituciones </ion-label>
      <button ion-button clear (click)="showSearch(true)"><ion-icon name="search"></ion-icon></button>
    </ion-title>
  </ion-navbar>
  <ion-searchbar *ngIf="showSearchBar" [showCancelButton]=true [animated]=true #searchbar (search)="filtersearch($event, true)" placeholder="Buscar" (ionCancel)="showSearch(false)">
  </ion-searchbar>
</ion-header>



<ion-content  class="common-list">

  <ion-fab *ngIf="!openbar" left bottom edge style="bottom: 10px;"  id="opensidebar" (click)="opensidebar()">
      <button ion-fab  menuToggle color=secondary> <!-- basic usage -->
      <i class="fa fa-filter" aria-hidden="true"></i></button>
    </ion-fab>

  <ion-grid>
    <ion-row>
      <ion-col *ngIf="openbar" class="filter-sidebar"  id="filter-sidebar" col-sm-8 col-8 col-md-8  col-lg-2 col-xl-2>
        <div *ngIf="openbar"  left top style="bottom: 10px;" class="closesidebar" >
            <button  menuToggle color=secondary (click)="closesidebar()"> <!-- basic usage -->
            <i class="fa fa-times" aria-hidden="true"></i></button>
          </div>
        <div id="filter-sidebar-div">
          <ion-list class="selec-header">
         <ion-item>
           <ion-label style="max-width: 60px !important;">Niveles </ion-label>
           <ion-select [(ngModel)]="selectedNiveles" multiple="true" cancelText="Cancelar" okText="Filtrar" (ionChange)="filter($event, false)" style="max-width: 56px !important;">
             <ion-option  *ngFor="let nivel of niveles | keys" value="{{niveles[nivel].id}}" selected="selectedNiveles.contains(nivel)">{{niveles[nivel].nombre}}</ion-option>

           </ion-select>



         </ion-item>
       </ion-list>
       <div class="select-all-div"><button ion-button center class="select-all" (click)="add_all_niveles();"><i class="fa fa-check" aria-hidden="true"></i> Seleccionar Todos</button></div>
       <button ion-button tooltip="El Estado agrupa sus distintas instituciones en entidades y niveles, siendo los niveles el mayor agrupador" class="tooltip-menu" duration=6000 positionV="bottom" arrow>
        <i class="fa fa-info-circle" clear color='light' aria-hidden="true"></i>
      </button>

        </div>
        <div class="chips-div">
          <ion-chip *ngFor="let nivel of selectedNiveles"  #chip (click)="gochip(chip, nivel)">
             <ion-label class="chip_text">{{niveles[nivel].nombre}}</ion-label>
             <button ion-button clear color=clear (click)="delete(chip, nivel)">
               <ion-icon name="close-circle"></ion-icon>
             </button>
           </ion-chip>
        </div>
        <div>
          <ion-slides pager class="helpslide">

             <ion-slide >
               <p>Necesitas Ayuda?</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon right class="right" name="ios-arrow-forward" color="default"  (click)="goToSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>

             <ion-slide >
               <p>Aquí puedes ver el listado de las Instituciones, agrupadas por niveles y entidades (si quieres saber más sobre esto puedes ir a la sección de información).</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon right class="right" name="ios-arrow-forward" color="default"  (click)="goToSlide()"></ion-icon>
                 <ion-icon left class="left" name="ios-arrow-back" color="default"  (click)="gobackSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>

             <ion-slide >
               <p>También puedes filtrar la información dentro de este menú.</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon right class="right" name="ios-arrow-forward" color="default"  (click)="goToSlide()"></ion-icon>
                 <ion-icon left class="left" name="ios-arrow-back" color="default"  (click)="gobackSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>

             <ion-slide >
               <p>Dentro de cada Institución puedes ver mas acerca de cada una; Visión, Misión, Líneas de Acción, entre Otros.</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon right class="right" name="ios-arrow-forward" color="default"  (click)="goToSlide()"></ion-icon>
                 <ion-icon left class="left" name="ios-arrow-back" color="default"  (click)="gobackSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>
             <ion-slide >
               <p>Tambien puedes comentar y calificar esta Información.</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon right class="right" name="ios-arrow-forward" color="default"  (click)="goToSlide()"></ion-icon>
                 <ion-icon left class="left" name="ios-arrow-back" color="default"  (click)="gobackSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>

             <ion-slide >
               <p>Además dentro de cada Entidad puedes ver un gráfico que muestra la cantidad de beneficiarios de cada programa</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon right class="right" name="ios-arrow-forward" color="default"  (click)="goToSlide()"></ion-icon>
                 <ion-icon left class="left" name="ios-arrow-back" color="default"  (click)="gobackSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>
             <ion-slide >
               <p>Esperamos haberte ayudado!</p>
               <ion-toolbar class="tutorial-buttons">
                 <ion-icon left class="left" name="ios-arrow-back" color="default"  (click)="gobackSlide()"></ion-icon>
               </ion-toolbar>
             </ion-slide>

           </ion-slides>
        </div>
      </ion-col>
      <ion-col [ngClass]="(!openbar ? 'central-col' : 'normal-col')" class="institucion_col" col-sm-12 col-md-12 offset-lg-2 offset-xl-2 col-lg-10 col-xl-10>

        <ion-list class='view-content'  >
          <div *ngFor="let niv of _niveles | keys">
            <ion-item class="item-grouper nivel-grouper">Nivel
               <p class="p_common_list">{{_niveles[niv]["nombre"]}}

               </p>

            </ion-item>
            <div *ngFor="let ent of _niveles[niv]['entidades'] | keys">
              <ion-item class="item-grouper middle-content entidad-grouper"><p class="p_sub_common_list">{{ _niveles[niv]["entidades"][ent]["nombre"]}}
                <button ion-button tooltip="Al hacer click en icono de la derecha puedes ver la grafica que muestra los beneficiarios de la entidad" class="tooltip-list" duration=6000 positionV="bottom" arrow>
                <i class="fa fa-info-circle" clear color='light' aria-hidden="true"></i>
              </button></p>
                <button ion-button clear (click)="itemTappedEst($event, _niveles[niv]['entidades'][ent]['instituciones'][appHelper.keys(_niveles[niv]['entidades'][ent]['instituciones'])[0]])"><i class="fa fa-pie-chart" aria-hidden="true"></i> </button>
              </ion-item>
              <button ion-item class="success"
               *ngFor="let item of _niveles[niv]['entidades'][ent]['instituciones'] | keys"
               [ngClass]="(!(_niveles[niv]['entidades'][ent]['instituciones'][item]['monto']==0 && _niveles[niv]['entidades'][ent]['instituciones'][item]['la']==0) ? 'list_sin_info' : '')" (click)="itemTapped($event, _niveles[niv]['entidades'][ent]['instituciones'][item])">
                <ion-item>
                  <ion-avatar item-start>
                      <i class="fa fa-bank"></i>
                  </ion-avatar>
                  <div class="item-list">
                    <h2>{{_niveles[niv]["entidades"][ent]["instituciones"][item]["nombre"]}}</h2>

                    <h5 >
                      <p>
                      <i class="fa fa-star" aria-hidden="true" [ngClass]="(_niveles[niv]['entidades'][ent]['instituciones'][item]['rating']>=1 ? 'normal-start' : 'especial-start')"  ></i>
                      <i class="fa fa-star" aria-hidden="true" [ngClass]="((_niveles[niv]['entidades'][ent]['instituciones'][item]['rating']>1.5) ? 'normal-start' : 'especial-start')"  ></i>
                        <i class="fa fa-star" aria-hidden="true" [ngClass]="((_niveles[niv]['entidades'][ent]['instituciones'][item]['rating']>2.5) ? 'normal-start' : 'especial-start')"  ></i>
                        <i class="fa fa-star" aria-hidden="true" [ngClass]="((_niveles[niv]['entidades'][ent]['instituciones'][item]['rating']>3.5) ? 'normal-start' : 'especial-start')"  ></i>
                        <i class="fa fa-star" aria-hidden="true" [ngClass]="((_niveles[niv]['entidades'][ent]['instituciones'][item]['rating']>4.5) ? 'normal-start' : 'especial-start')"  ></i>
                        {{_niveles[niv]['entidades'][ent]['instituciones'][item]['comment']}} comentario/s
                         - {{_niveles[niv]['entidades'][ent]['instituciones'][item]['views']}} visita/s
                          - {{_niveles[niv]['entidades'][ent]['instituciones'][item]['downloads']}} descarga/s
                      </p>
                    <ion-badge class="label_c2"><i class="fa fa-money" aria-hidden="true"></i>{{appHelper.numberFormatter(_niveles[niv]["entidades"][ent]["instituciones"][item]["monto"])}} Gs.</ion-badge>
                    <ion-badge class="label_c4"><i class="fa fa-line-chart" aria-hidden="true"></i>{{_niveles[niv]["entidades"][ent]["instituciones"][item]["la"]}}</ion-badge>
                  </h5>
                  </div>
                  <ion-icon ios="ios-arrow-forward" md="ios-arrow-forward" class="right"></ion-icon>
                </ion-item>
              </button>
            </div>
          </div>
        </ion-list>
      </ion-col>
      <ion-col [ngClass]="(!openbar ? 'central-col footer_col footer_content' : 'normal-col footer_content')" col-sm-12 col-md-12 offset-lg-2 offset-xl-2 col-lg-10 col-xl-10>
        <ppy-footer></ppy-footer>
      </ion-col>
    </ion-row>



  </ion-grid>


</ion-content>
